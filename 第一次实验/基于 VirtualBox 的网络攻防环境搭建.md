# 基于 VirtualBox 的网络攻防环境搭建

##### 2019302120121 信息安全2班 张秉杰

## 实验目的

###### 掌握 VirtualBox 虚拟机的安装与使用；

###### 掌握 VirtualBox 的虚拟网络类型和按需配置；

###### 掌握 VirtualBox 的虚拟硬盘多重加载；

## 实验环境

###### VirtualBox 虚拟机

###### 攻击者主机（Attacker）：Kali

###### 网关（Gateway）：Debian

###### 靶机（Victim）：Debian / xp-sp3 / Kali

## 实验要求

虚拟硬盘配置成多重加载

 网络拓扑图与搭建

 网络连通性测试

 靶机可以直接访问攻击者主机

 攻击者主机无法直接访问靶机

 网关可以直接访问攻击者主机和靶机

 靶机的所有对外上下行流量必须经过网关

 所有节点均可以访问互联网

## 实验过程

### 1.虚拟硬盘配置成多重加载

左上角打开管理，打开虚拟介质管理

选中对应虚拟盘，改为多重加载，释放盘片

![1630926759994](1630926759994.png)

创建6个虚拟机：kali，debain，xp系统各两个

其中一个作为攻击者，一个作为网关，另外4个作为靶机



![1630927789049](1630927789049.png)

 ##### 网关的四块网卡配置： 

NAT网络：网关可以访问攻击者主机

开启Host-Only：方便使用ssh

两块内部网络：搭建两个独立的局域网intnet1和intnet2

![1630928249842](1630928249842.png)

然后开始配置网卡（不需要配置，发现已经配置好了）

网卡配置结果：

![1630979554741](1630979554741.png)

![1630932456874](1630932456874.png)

![1630932505479](1630932505479.png)

#####  靶机配置

 xp配置时将控制芯片改成`Intel Pro/1000T` 服务器 

![1630930701421](1630930701421.png)

![1630979690160](1630979690160.png)

其IP：

![1630980087440](1630980087440.png)

![1630979973288](1630979973288.png)

 ##### Debian和Kali靶机只需要将网络改为拓扑图对应的内部网络。 

其ip：

![1630979877326](1630979877326.png)

![1630979907209](1630979907209.png)

kali victim直接访问 kali attacker

![1630933664995](1630933664995.png)

 

 Debian-victim-2访问kali-attacker 

![1630933880784](1630933880784.png)

 xp-victim-1访问kali-attacker 

![1630934007578](1630934007578.png)

 xp-victim-2访问kali-attacker 

![1630934368602](1630934368602.png)

##### 攻击者主机无法直接访问靶机

![1630936344334](1630936344334.png)

##### 网关可以直接访问攻击者主机和靶机

先关闭xp的防火墙

![1630936693590](1630936693590.png)

![1630936725424](1630936725424.png)

 靶机的所有对外上下行流量必须经过网关&所有节点均可以访问互联网

先在网关上安装tcpdump ， 并对对应网卡进行监控。在各个节点上访问互联网，观察捕获到了上下行的包 。

```
apt insatll tcpdump
```

然后cd进入user/sbin

执行 tcpdump ：-i enp0s3

网关可以访问互联网： 

![1630936793495](1630936793495.png)

 kali-attacker可以访问互联网 

![1630936839415](1630936839415.png)

 victim-kali-1可以访问互联网 

![1630936878375](1630936878375.png)

 上下行流量经过网关：

![1630980985889](1630980985889.png)

 victim-debian2可以访问互联网 

![1630937121676](1630937121676.png)





 xp-victim-1  可以访问互联网 

![1630979078643](1630979078643.png)

 上下行流量经过网关： 

![1630981300546](1630981300546.png)

 xp-victim-2可以访问互联网 

![1630979222044](1630979222044.png)

 上下行流量经过网关： 

![1630981482369](1630981482369.png)